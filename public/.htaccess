# CMS Public Front Controller
# All requests to non-existent files route to index.php

RewriteEngine On
RewriteBase /

# Serve existing files directly
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^(.*)$ index.php [QSA,L]

# Security headers
<IfModule mod_headers.c>
    Header always set X-Content-Type-Options "nosniff"
    Header always set X-Frame-Options "SAMEORIGIN"
    Header always set X-XSS-Protection "1; mode=block"
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
</IfModule>

# Disable directory listings
Options -Indexes

# Block dotfiles (except .well-known for Let's Encrypt)
<FilesMatch "^\.(?!well-known)">
    Require all denied
</FilesMatch>

# Block sensitive file extensions
<FilesMatch "\.(env|log|bak|sql|ini|yml|yaml)$">
    Require all denied
</FilesMatch>
